\documentclass[a4paper, 12pt]{article}

\usepackage{fontspec}   %加這個就可以設定字體
\usepackage{xeCJK}       %讓中英文字體分開設置
\usepackage{zhnumber}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{etoolbox}
\usepackage{tcolorbox}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage{appendix}
\usepackage{titlesec}
\usepackage{titling}
\usepackage{newunicodechar}
\usepackage{tocloft} % adding the tocloft package for toc customization
\usepackage{lipsum}

\usepackage[english]{babel}
\usepackage[autostyle]{csquotes}

\usepackage[sorting=nty]{biblatex}
\addbibresource{ref.bib}

\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}

\renewcommand\tabularxcolumn[1]{m{#1}}% for vertical centering text in X column
\newcolumntype{Y}{>{\centering\arraybackslash}X}


\usepackage[
  top=2cm,
  bottom=2cm,
  left=2cm,
  right=2cm,
%  headheight=17pt, % as per the warning by fancyhdr
%  includehead,
  includefoot,
  heightrounded, % to avoid spurious underfull messages
]{geometry} 

\newcounter{mysec}[section]
\renewcommand\thesection{%
    \addtocounter{mysec}{1}%
    \zhnum[style={Traditional,Financial}]{mysec}、}
\renewcommand\thesubsection{\zhnum{subsection}、} % added a 、
\renewcommand\thesubsubsection{（\zhnum{subsubsection}）} % added parentheses
% (full-width, don't know if that's what you want)
\renewcommand\theparagraph{} % you don't want paragraph numbers
\renewcommand\thesubparagraph{} % nor subparagraph numbers

% we have to adjust the spacing in the toc because the section label is longer than usual
\addtolength\cftsecnumwidth{1em}
\addtolength\cftsubsecindent{1em}
\addtolength\cftsubsubsecindent{1em}

% here we need to make sure the normal section counter is accessed
\titleformat{\section}{\Large\bfseries\filcenter}
    {\zhnum[style={Traditional,Financial}]{section}、}{.5em}{}
% not really sure what you intend to achieve with \fontsize but I'll leave it here
\titleformat*{\subsection}{\fontsize{12}{12}\bfseries} 
\titleformat*{\subsubsection}{\fontsize{12}{12}\bfseries}

% no extra version for numberless is necessary since no numbers are used anyways
% also you get newlines from omitting the [display] in \titleformat already
\titleformat{\paragraph}
    {\fontsize{14}{14}\bfseries}{}{0em}{} 
\titleformat{\subparagraph}
    {\fontsize{12}{12}\bfseries}{}{0em}{}
% we need the following so that they don't indent (second argument, 0em);
% you'll have to adjust the spacing though since this is not display style anymore:
\titlespacing*{\paragraph}{0em}{3.25ex plus 1ex minus .2ex}{.75ex plus .1ex} 
\titlespacing*{\subparagraph}{0em}{3.25ex plus 1ex minus .2ex}{.75ex plus .1ex}

\renewcommand{\maketitlehooka}{\sffamily}

\renewcommand{\baselinestretch}{1.5}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot{}
\fancyhead{}
\cfoot{\footnotesize \thepage}




\addto\captionsenglish{%
  \renewcommand\appendixname{附錄}
  \renewcommand\appendixpagename{附錄}
  \renewcommand{\contentsname}{目錄}
  \renewcommand{\figurename}{圖}
}
\captionsetup[table]{name=表}
%\lhead{利用VAE-pix2pix生成擬真的山脈模型}
%\rhead{2021臺灣國際科學展覽會研究報告}

%\rfoot{李杰穎}

\lstset{basicstyle=\ttfamily, keywordstyle=\bfseries}

\setCJKmainfont{新細明體}[AutoFakeBold]
\setmainfont{Times New Roman}
\setmonofont{Consolas}
\XeTeXlinebreaklocale "zh"             %這兩行一定要加，中文才能自動換行
\XeTeXlinebreakskip = 0pt plus 1pt     %這兩行一定要加，中文才能自動換行
\title{標題}
\author{作者名}

\setlength{\parindent}{2em}
\setlength{\parskip}{0.5em}


\renewcommand{\thefootnote}{\roman{footnote}}

\begin{document}
\pagenumbering{roman}
%\maketitle
%\newpage
\tableofcontents
\newpage

\begin{abstract}
\lipsum[1-3]
\end{abstract}
\section*{摘要}
\lipsum[1-3]
\newpage
\pagenumbering{arabic}

\section{前言}

\subsection{研究動機}
\lipsum[1-3]

\subsection{研究目的}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{fig/3.jpg}
    \caption{pix2pix可做到的圖像風格轉換(取自\cite{isola2017image})}
    \label{fig:3}
\end{figure}

\lipsum[1-3]
\begin{itemize}
    \item item 1
    \item item 2
\end{itemize}

\section{研究過程與方法}

\lipsum[1-3]

\section{研究結果與討論}
\lipsum[1-3]

\section{結論與應用}

\lipsum[1-3]

\nocite{*}
\printbibliography[title={參考文獻}]

\newpage
\appendixpage
\begin{appendices}
\section{附錄1}
\lipsum[1-3]

\end{appendices}
\end{document}
